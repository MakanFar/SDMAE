2025-10-02 22:54:23,640 - INFO - ================================================================================
2025-10-02 22:54:23,640 - INFO - SDGNN with Motif-based Higher-order Learning (Enhanced)
2025-10-02 22:54:23,640 - INFO - ================================================================================
2025-10-02 22:54:23,640 - INFO - NUM_NODE: 3783
2025-10-02 22:54:23,640 - INFO - WEIGHT_DECAY: 0.001
2025-10-02 22:54:23,640 - INFO - NODE_FEAT_SIZE: 20
2025-10-02 22:54:23,640 - INFO - EMBEDDING_SIZE: 20
2025-10-02 22:54:23,640 - INFO - LEARNING_RATE: 0.001
2025-10-02 22:54:23,640 - INFO - BATCH_SIZE: 500
2025-10-02 22:54:23,640 - INFO - EPOCHS: 20
2025-10-02 22:54:23,640 - INFO - DROPOUT: 0.0
2025-10-02 22:54:23,640 - INFO - AGGREGATOR: attention
2025-10-02 22:54:23,640 - INFO - ALPHA: 0.01
2025-10-02 22:54:23,640 - INFO - BETA: 0.01
2025-10-02 22:54:23,640 - INFO - DEVICE: cpu
2025-10-02 22:54:23,640 - INFO - ================================================================================
2025-10-02 22:54:23,640 - INFO - Starting training for dataset: bitcoin_alpha, fold: 1
2025-10-02 22:54:23,640 - INFO - Configuration: {'devices': 'cpu', 'seed': 13, 'epochs': 20, 'lr': 0.001, 'weight_decay': 0.001, 'dataset': 'bitcoin_alpha', 'dim': 20, 'fea_dim': 20, 'batch_size': 500, 'dropout': 0.0, 'k': '1', 'agg': 'attention', 'alpha': 0.01, 'beta': 0.01, 'max_pos_per_u': 50, 'max_neg_per_u': 50, 'eval_every': 5, 'patience': 15, 'warmup_epochs': 5, 'use_cache': True, 'lr_schedule': True, 'grad_clip': 5.0, 'triad_samples': 10000, 'triad_prob': 0.8, 'motif_scale': 1.0, 'motif_loss_type': 'cosine'}
2025-10-02 22:54:23,683 - INFO - Data loaded in 0.04s
2025-10-02 22:54:23,683 - INFO - Building motif structures...
2025-10-02 22:54:25,548 - INFO - Sampled 503577 triads
2025-10-02 22:54:44,941 - INFO - [motif:out_in_pos] nnz=16864, mean=0.853094
2025-10-02 22:54:44,941 - INFO - [motif:out_in_neg] nnz=1162, mean=0.973187
2025-10-02 22:54:44,957 - INFO - [motif:co_out] nnz=442240, mean=0.879861
2025-10-02 22:54:44,982 - INFO - [motif:co_in] nnz=561608, mean=0.889656
2025-10-02 22:54:44,984 - INFO - [motif:out_in_pos] shape=(3786, 3786), nnz=16864, density=0.001177, range=(2.252834054826979e-07, 29.190069311594343)
2025-10-02 22:54:44,984 - INFO - [motif:out_in_neg] shape=(3786, 3786), nnz=1162, density=0.000081, range=(1.67814470199422e-07, 6.3529870853877215)
2025-10-02 22:54:44,985 - INFO - [motif:co_out] shape=(3786, 3786), nnz=442240, density=0.030853, range=(0.003749479514305927, 11.634639906797984)
2025-10-02 22:54:44,985 - INFO - [motif:co_in] shape=(3786, 3786), nnz=561608, density=0.039181, range=(0.004235200730256819, 11.234090627181821)
2025-10-02 22:54:44,985 - INFO - Triads indexed for 3622 unique nodes
2025-10-02 22:54:44,985 - INFO - Motif structures built in 21.30s
2025-10-02 22:54:46,817 - INFO - Total initialization time: 23.18s
2025-10-02 22:54:46,817 - INFO - Starting training...
2025-10-02 22:54:47,240 - INFO - motif_energy_pos=0.011831, motif_energy_neg=4.454892
2025-10-02 22:54:47,275 - INFO - dot_pos_mu=4.445±0.167, dot_neg_mu=4.440±0.169
2025-10-02 22:54:51,160 - INFO - Epoch 0: epoch=0, accuracy=0.5909, f1_micro=0.7314, f1_macro=0.4368, f1_weighted=0.5909, auc=0.6017, eval_time=4.3437
2025-10-02 22:54:51,373 - ERROR - Training failed with error: cannot access local variable 'motif_loss' where it is not associated with a value
2025-10-02 22:54:51,373 - ERROR - Traceback (most recent call last):
  File "C:\Users\Makan\Documents\code\SDMAE\sdgnn.py", line 1297, in main
    run(dataset=dataset, k=K)
  File "C:\Users\Makan\Documents\code\SDMAE\sdgnn.py", line 1207, in run
    loss, batch_loss_dict = model.criterion_motif(
                            ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Makan\Documents\code\SDMAE\sdgnn.py", line 841, in criterion_motif
    total_loss = weighted_loss(edge_loss, motif_loss, triad_loss)
                                          ^^^^^^^^^^
UnboundLocalError: cannot access local variable 'motif_loss' where it is not associated with a value

